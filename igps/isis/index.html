<!DOCTYPE html>
<html>
  <head>
    <title>overloaded bits</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="revised" content="2019-07-12T09:20:44 DST">
<title>IS-IS :: overloaded bits</title>
<link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link href="/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/nucleus.css" rel="stylesheet">
<link href="/theme-flex/style.css" rel="stylesheet">

	<link href="/theme-flex/variant-gold.css" rel="stylesheet">

<link rel="stylesheet" href="/css/bootstrap.min.css">
<script src="/js/jquery-2.x.min.js"></script>
<script type="text/javascript">
      var baseurl = "\/";
</script>
<meta name="description" content="Integrated IS-IS">



    
  </head>
  <body data-url="/igps/isis/">
    
      <header>
  <div class="logo">
    
	
  
    <a class="baselink" href="/">overloaded bits</a>
  


  </div>
  <div class="burger"><a href="javascript:void(0);" style="font-size:15px;">&#9776;</a></div>
    <nav class="shortcuts">
            <li class="" role="">
                <a href="https://github.com/ferfemar"  rel="noopener">
                  <i class='fa fa-github'></i> <label>Github repo</label>
                </a>
            </li>
    </nav>
</header>
<article>
  <aside>
    <ul class="menu">
          <li data-nav-id="/" class="dd-item">
          <a href="/">
            <i class="fa fa-fw fa-home"></i>
          </a>
          </li>
    <li data-nav-id="/ipspace-course-notes/" class="dd-item haschildren
        ">
      <div>
      <a href="/ipspace-course-notes/">Building Network Automation Solutions Course Notes</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/ipspace-course-notes/watch-list/" class="dd-item">
        <div>
          <a href="/ipspace-course-notes/watch-list/">
            List of materials to study
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/certs/" class="dd-item haschildren
        ">
      <div>
      <a href="/certs/">Certifications</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/certs/jncix-sp/" class="dd-item">
        <div>
          <a href="/certs/jncix-sp/">
            JNCIx-SP
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/igps/" class="dd-item parent haschildren
        ">
      <div>
      <a href="/igps/">IGPs</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/igps/isis/" class="dd-item active">
        <div>
          <a href="/igps/isis/">
            IS-IS
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/igps/ospf/" class="dd-item">
        <div>
          <a href="/igps/ospf/">
            OSPF
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/mpls-vpns/" class="dd-item haschildren
        ">
      <div>
      <a href="/mpls-vpns/">MPLS VPNs</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/mpls-vpns/vpls/" class="dd-item">
        <div>
          <a href="/mpls-vpns/vpls/">
            VPLS
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/multicast/" class="dd-item haschildren
        ">
      <div>
      <a href="/multicast/">Multicast</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/multicast/igmp/" class="dd-item">
        <div>
          <a href="/multicast/igmp/">
            IGMP
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/netops/" class="dd-item haschildren
        ">
      <div>
      <a href="/netops/">Netops</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/netops/ansible/" class="dd-item haschildren
        ">
      <div>
      <a href="/netops/ansible/">Ansible</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/netops/ansible/ansible-w-junos/" class="dd-item">
        <div>
          <a href="/netops/ansible/ansible-w-junos/">
            Ansible for Junos basics
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/netops/ansible/working-with-timestamp/" class="dd-item">
        <div>
          <a href="/netops/ansible/working-with-timestamp/">
            Ansible timestamps
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/netops/git/" class="dd-item haschildren
        ">
      <div>
      <a href="/netops/git/">GIT</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/netops/git/panic_buttons/" class="dd-item">
        <div>
          <a href="/netops/git/panic_buttons/">
            Git Panic Commands
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/netops/python/" class="dd-item haschildren
        ">
      <div>
      <a href="/netops/python/">Python</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/netops/python/python-virtualenvs/" class="dd-item">
        <div>
          <a href="/netops/python/python-virtualenvs/">
            Python Virtual Enviroments
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/netops/python/python-basics/" class="dd-item">
        <div>
          <a href="/netops/python/python-basics/">
            Python basics
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li data-nav-id="/vendors/" class="dd-item haschildren
        ">
      <div>
      <a href="/vendors/">Vendor specifics</a><i class="fa fa-angle-right fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/vendors/iosxe_cli/" class="dd-item">
        <div>
          <a href="/vendors/iosxe_cli/">
            IOS-XE CLI
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/vendors/junos_cli/" class="dd-item">
        <div>
          <a href="/vendors/junos_cli/">
            Junos CLI
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>




    </ul>
    <section>
    </section>
  </aside>
  <section class="page">
    
    <div class="nav-select">
      <center>Navigation : 
        <select onchange="javascript:location.href = this.value;">
          
    <option value="/ipspace-course-notes/" >
   Building Network Automation Solutions Course Notes</option>
    <option value="/certs/" >
   Certifications</option>
    <option value="/igps/" >
   IGPs</option> 
      <option value="/igps/isis/"  selected> IS-IS</option>
      <option value="/igps/ospf/" > OSPF</option>
  
    <option value="/mpls-vpns/" >
   MPLS VPNs</option>
    <option value="/multicast/" >
   Multicast</option>
    <option value="/netops/" >
   Netops</option>
    <option value="/vendors/" >
   Vendor specifics</option>



        </select>
      </center>
    </div>
      <div>
        <div class="searchbox">
          <input data-search-input id="search-by" type="text" placeholder="Search...">
        </div>
        <script type="text/javascript" src="/js/lunr.min.js"></script>
        <script type="text/javascript" src="/js/auto-complete.js"></script>
        <link href="/css/auto-complete.css" rel="stylesheet">
        <script type="text/javascript">
          
              var baseurl = "\/";
          
        </script>
        <script type="text/javascript" src="/js/search.js"></script>
      </div>
    

    <h1>IS-IS</h1>
    
    
    
    

<p>Integrated IS-IS</p>

<h2 id="basics">Basics</h2>

<ul>
<li>originaly ISO protocol</li>
<li><a href="https://tools.ietf.org/pdf/rfc1195.pdf">RFC 1195</a> defined for (also) routing TCP/IP</li>
<li>SPF algoritm / Dijkstra</li>
</ul>

<h2 id="iso-adressing">ISO Adressing</h2>

<ul>
<li>Address consists of: IDP + DSP

<ul>
<li>IDP = Initial Domain Part

<ul>
<li>part standardized by ISO, specifies format &amp; addressing authority for DSP part</li>
</ul></li>
<li>DSP = Domain Specific Part

<ul>
<li>HO-DSP (High Order part of DSL)</li>
<li>ID (system identifier)</li>
<li>SEL (NSAP selector)</li>
</ul></li>
</ul></li>
<li>IDP+HO-DSP can be called area address

<ul>
<li>for transition purposes there might be multiple area addresses in one area</li>
<li>area address in OSI addressing allows l1 routers to identify packets to destinations outside their area</li>
</ul></li>
</ul>

<h2 id="iso-areas">ISO Areas</h2>

<ul>
<li>Level 1 and Level 2 areas</li>
<li>Level 1

<ul>
<li>L1 routers know the topology inside their area; they do not know the identity of routers outside their area</li>
<li>L1 routers forward all traffic for destinations outside their area to level 2 router in their area</li>
<li>L1 routers within an area, based on ID portion of the ISO address</li>
<li>L1 routers examine the ISO address, if within their own area then they route towards destination, if not they ship the packet to nearest L2 router</li>
<li>L1 router will become neighbor only with routers in the SAME area</li>
</ul></li>
<li>Level 2

<ul>
<li>L2 routers in Level 2 area do not need to know the topology of level 1 areas as well</li>
<li>L2 routers route based on area address (IDP+HO-DSP), they route towards areas (without regard to the internal structure of the area)</li>
<li>L2 router will become neighbor with another L2 router REGARDLESS of area address

<ul>
<li>only L2 LSPs will flow on link between two different areas</li>
</ul></li>
</ul></li>
<li>L2 router might be also L1 router in one area<br /></li>
</ul>

<h2 id="ip-areas">IP areas</h2>

<ul>
<li>Level 1

<ul>
<li>L1 routers route via L1 routing if destination address MATCHES [IP address, subnet mask, metric] found reachable withing the area</li>
<li>L1 routes route to nearest L2 router if destination address DOES NOT MATCH ANY [IP address, subnet mask, metric] found reachable withing the area</li>
</ul></li>
<li>Level 2

<ul>
<li>L2 routers include in their L2 LSPs a comple list of  [IP address, subnet mask, metric] specifying all IP addresses found in their area, this is obtained from L1 routers (or configured manually)</li>
<li>default routes are permitted only at L2</li>
</ul></li>
</ul>

<h2 id="broadcast-segments-lans">Broadcast segments (LANs)</h2>

<ul>
<li>Problem:

<ul>
<li>multiple routers on LAN - each router would announce a link to every other router (n^2 links reported)</li>
</ul></li>
<li>Solution:

<ul>
<li>create a pseudonode representing the LAN, each router announces it has a link to the pseudonode</li>
<li>one router is selected to send LSP on behalf of the pseudonode (designated router); reporting links to all of the router on the LAN</li>
</ul></li>
</ul>

<h2 id="3-way-handshaking">3-Way handshaking</h2>

<ul>
<li>LAN Hello uses the IS Neighbors TLV to list all neighbors from which a hello has been received</li>

<li><p>P2P Hellos do not carry IS Neighbors TLVs. ISO 10589 prescribes only two-way handshaking in this case. RFC 3373 specifies P2P Three-way Adjacency TLV (240)</p>

<pre><code>Point-to-point Adjacency State (t=240, l=15)
Type: 240
Length: 15
Adjacency State: Up (0)
Extended Local circuit ID: 0x00000048
Neighbor SystemID: 1720.1600.1002
Neighbor Extended Local circuit ID: 0x00000047
</code></pre></li>
</ul>

<h2 id="adjacency-states">Adjacency states</h2>

<ul>
<li>Up</li>
<li>Initializing</li>
<li>Down</li>
</ul>

<h2 id="debug-outputs">Debug outputs</h2>

<p><strong>set protocols isis traceoptions flag state</strong>
reset isis adjacency</p>

<pre><code>Jun 16 15:41:36.289849 Adjacency state change, vSRX1, state Up -&gt; Down
Jun 16 15:41:36.289923     interface ge-0/0/0.0, level 3
Jun 16 15:41:36.291278 ISIS L3 neighbor vSRX1 on interface ge-0/0/0.0 deleted
Jun 16 15:41:36.293005 ISIS programmed L3 periodic xmit to 09:00:2b:00:00:05 interface ge-0/0/0.0, interval 9 secs 0 nsecs
Jun 16 15:41:36.314703 Adjacency state change, vSRX1, state Down -&gt; Initializing
Jun 16 15:41:36.314769     interface ge-0/0/0.0, level 3
Jun 16 15:41:36.316573 ISIS L3 neighbor vSRX1 on interface ge-0/0/0.0 set 27 secs 0 nsecs
Jun 16 15:41:36.318667 ISIS programmed L3 periodic xmit to 09:00:2b:00:00:05 interface ge-0/0/0.0, interval 9 secs 0 nsecs
Jun 16 15:41:36.344605 Adjacency state change, vSRX1, state Initializing -&gt; Up
Jun 16 15:41:36.344654     interface ge-0/0/0.0, level 3
Jun 16 15:41:36.345246 Starting database exchange on ge-0/0/0.0
Jun 16 15:41:36.346720 ISIS L3 neighbor vSRX1 on interface ge-0/0/0.0 set 27 secs 0 nsecs
Jun 16 15:41:36.348422 ISIS programmed L3 periodic xmit to 09:00:2b:00:00:05 interface ge-0/0/0.0, interval 9 secs 0 nsecs
</code></pre>

<p><strong>set protocols isis traceoptions flag packets</strong></p>

<pre><code>*** debugisis ***
Jun 16 15:53:21 vSRX2 clear-log[1337]: logfile cleared
Jun 16 15:53:24.345379 Received PTP IIH, source id vSRX1 on ge-0/0/0.0
Jun 16 15:53:24.346181 Sending PTP IIH on ge-0/0/0.0
Jun 16 15:53:24.346226     packet length 48
Jun 16 15:53:24.360054 Received PTP IIH, source id vSRX1 on ge-0/0/0.0
Jun 16 15:53:24.360373 Sending PTP IIH on ge-0/0/0.0
Jun 16 15:53:24.360431     packet length 1492
Jun 16 15:53:24.374327 Updating L1 LSP vSRX2.00-00 in TED
Jun 16 15:53:24.374646 Updating L2 LSP vSRX2.00-00 in TED
Jun 16 15:53:24.375810 Received PTP IIH, source id vSRX1 on ge-0/0/0.0
Jun 16 15:53:24.376482 Sending PTP IIH on ge-0/0/0.0
Jun 16 15:53:24.376527     packet length 58
Jun 16 15:53:24.400416 Received L1 LSP vSRX1.00-00, on interface ge-0/0/0.0
Jun 16 15:53:24.400464     from vSRX1
Jun 16 15:53:24.400504     sequence 0x10, checksum 0xfaea, lifetime 1198
Jun 16 15:53:24.400571 Updating L1 LSP vSRX1.00-00 in TED
Jun 16 15:53:24.400901 Updating L1 LSP vSRX2.00-00 in TED
Jun 16 15:53:24.401244 Sending L1 LSP vSRX2.00-00 on interface ge-0/0/0.0
Jun 16 15:53:24.401283     sequence 0x12, checksum 0xe4fa, lifetime 1200
Jun 16 15:53:24.401322     packet length 150
Jun 16 15:53:24.401736 Updating L2 LSP vSRX2.00-00 in TED
Jun 16 15:53:24.420761 Received L2 LSP vSRX1.00-00, on interface ge-0/0/0.0
Jun 16 15:53:24.420810     from vSRX1
Jun 16 15:53:24.420861     sequence 0x10, checksum 0x5c3f, lifetime 1198
Jun 16 15:53:24.420919 Updating L2 LSP vSRX1.00-00 in TED
Jun 16 15:53:24.421266 Sending L2 LSP vSRX2.00-00 on interface ge-0/0/0.0
Jun 16 15:53:24.421306     sequence 0x12, checksum 0xff97, lifetime 1200
Jun 16 15:53:24.421344     packet length 171
Jun 16 15:53:25.281547 Sending L1 PSN on interface ge-0/0/0.0
Jun 16 15:53:25.281635     packet length 35
Jun 16 15:53:25.281684 Sending L2 PSN on interface ge-0/0/0.0
Jun 16 15:53:25.281723     packet length 35
Jun 16 15:53:25.298222 Received L1 PSN, source vSRX1, interface ge-0/0/0.0
Jun 16 15:53:25.299512 Received L2 PSN, source vSRX1, interface ge-0/0/0.0
Jun 16 15:53:31.810825 ISIS L3 hello from vSRX1 interface ge-0/0/0.0 absorbed
Jun 16 15:53:32.923675 ISIS L3 periodic xmit to 09:00:2b:00:00:05 interface ge-0/0/0.0
Jun 16 15:53:35.429957 Sending L1 CSN on interface ge-0/0/0.0
Jun 16 15:53:35.430041     LSP range 0000.0000.0000.00-00 to ffff.ffff.ffff.ff-ff
Jun 16 15:53:35.430091     packet length 67
Jun 16 15:53:35.441234 Received L1 CSN, source vSRX1, interface ge-0/0/0.0
Jun 16 15:53:35.441279     LSP range 0000.0000.0000.00-00 to ffff.ffff.ffff.ff-ff
Jun 16 15:53:35.441318     packet length 67
Jun 16 15:53:35.454423 Sending L2 CSN on interface ge-0/0/0.0
Jun 16 15:53:35.454480     LSP range 0000.0000.0000.00-00 to ffff.ffff.ffff.ff-ff
Jun 16 15:53:35.454520     packet length 67
Jun 16 15:53:35.460799 Received L2 CSN, source vSRX1, interface ge-0/0/0.0
Jun 16 15:53:35.460849     LSP range 0000.0000.0000.00-00 to ffff.ffff.ffff.ff-ff
Jun 16 15:53:35.460887     packet length 67
Jun 16 15:53:40.434039 Sending L1 CSN on interface ge-0/0/0.0
Jun 16 15:53:40.434126     LSP range 0000.0000.0000.00-00 to ffff.ffff.ffff.ff-ff
Jun 16 15:53:40.434167     packet length 67
Jun 16 15:53:40.446845 ISIS L3 hello from vSRX1 interface ge-0/0/0.0 absorbed
Jun 16 15:53:40.448599 Received L1 CSN, source vSRX1, interface ge-0/0/0.0
Jun 16 15:53:40.448641     LSP range 0000.0000.0000.00-00 to ffff.ffff.ffff.ff-ff
Jun 16 15:53:40.448679     packet length 67
Jun 16 15:53:40.458292 Sending L2 CSN on interface ge-0/0/0.0
Jun 16 15:53:40.458352     LSP range 0000.0000.0000.00-00 to ffff.ffff.ffff.ff-ff
Jun 16 15:53:40.458392     packet length 67
Jun 16 15:53:40.475493 Received L2 CSN, source vSRX1, interface ge-0/0/0.0
Jun 16 15:53:40.475543     LSP range 0000.0000.0000.00-00 to ffff.ffff.ffff.ff-ff
Jun 16 15:53:40.475583     packet length 67
</code></pre>


    
    
        <div class="chevrons">
    <div id="navigation">
<a class="nav nav-prev" href="/igps/" title="IGPs"> <i class="fa fa-chevron-left"></i><label>IGPs</label></a>
    <a class="nav nav-next" href="/igps/ospf/" title="OSPF" style="margin-right: 0px;"><label>OSPF</label><i class="fa fa-chevron-right"></i></a></div>
  </div>

  </section>
</article>

<footer>

<div class="footline">
    

    

    
    <div class="date">
        <i class='fa fa-calendar'></i> Last update on 16/06/2019
    </div>
    

    
  </div>


	<div>


  
    Create a content/_footer.md file to customize the footer content
  



	</div>
</footer>

<script src="/js/clipboard.min.js"></script>

<link href="/css/featherlight.min.css" rel="stylesheet">
<script src="/js/featherlight.min.js"></script>



<script src="/theme-flex/script.js"></script>


    

    
    

    
  </body>
</html>